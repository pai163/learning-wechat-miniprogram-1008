<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦ä¹ éª°å­ - ä¸“æ³¨å­¦ä¹ çš„å°ç¨‹åº</title>
    <!-- å¼•å…¥Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- å¼•å…¥Chart.jsç”¨äºæ•°æ®å¯è§†åŒ– -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    
    <!-- Tailwindé…ç½® -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FF6B6B',
                        secondary: '#4ECDC4',
                        accent: '#FFD166',
                        success: '#06D6A0',
                        warning: '#FF9F1C',
                        danger: '#EF476F',
                        light: '#F7FFF7',
                        dark: '#292F36'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    animation: {
                        'bounce-slow': 'bounce 2s infinite',
                        'spin-slow': 'spin 3s linear infinite',
                        'float': 'float 3s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        }
                    }
                },
            }
        }
    </script>
    
    <!-- è‡ªå®šä¹‰æ ·å¼ -->
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .shadow-card {
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            .gradient-primary {
                background: linear-gradient(135deg, #FF6B6B 0%, #EF476F 100%);
            }
            .gradient-secondary {
                background: linear-gradient(135deg, #4ECDC4 0%, #06D6A0 100%);
            }
            .gradient-accent {
                background: linear-gradient(135deg, #FFD166 0%, #FF9F1C 100%);
            }
            
            /* éª°å­æ ·å¼ */
            .dice {
                display: flex;
                align-items: center;
                justify-content: center;
                position: relative;
                border-radius: 12px;
                box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.1);
                background-color: white;
            }
            
            /* éª°å­ç‚¹æ ·å¼ */
            .dice-dot {
                position: absolute;
                width: 18%;
                height: 18%;
                border-radius: 50%;
            }
            
            /* ä»»åŠ¡éª°å­ - ä½¿ç”¨secondaryé¢œè‰² */
            .dice-task .dice-dot {
                background-color: #4ECDC4;
            }
            
            /* å¥–åŠ±éª°å­ - ä½¿ç”¨primaryé¢œè‰² */
            .dice-reward .dice-dot {
                background-color: #FF6B6B;
            }
            
            /* éª°å­ç‚¹çš„ä½ç½® */
            .dice-dot-1 {
                top: 20%;
                left: 20%;
            }
            .dice-dot-2 {
                top: 20%;
                right: 20%;
            }
            .dice-dot-3 {
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
            }
            .dice-dot-4 {
                bottom: 20%;
                left: 20%;
            }
            .dice-dot-5 {
                bottom: 20%;
                right: 20%;
            }
            .dice-dot-6 {
                top: 50%;
                left: 20%;
                transform: translateY(-50%);
            }
            .dice-dot-7 {
                top: 50%;
                right: 20%;
                transform: translateY(-50%);
            }
        }
    </style>
</head>
<body class="bg-light font-sans text-dark min-h-screen flex flex-col">
    <!-- ä¸»å®¹å™¨ -->
    <div id="app" class="flex-1 flex flex-col">
        <!-- é¡µé¢å†…å®¹åŒºåŸŸ -->
        <div id="page-content" class="flex-1 p-4">
            <!-- ä»»åŠ¡Tabå†…å®¹ -->
            <div id="tasks-tab" class="h-full flex flex-col">
                <!-- é¡¶éƒ¨å½“å‰ä»»åŠ¡å¡ç‰‡ -->
                <div class="bg-gradient-to-r from-secondary to-success rounded-2xl p-6 mb-6 shadow-lg transform transition-all hover:scale-[1.01]">
                    <div class="text-center">
                        <h2 id="current-task" class="text-gray-700 mb-2">ç‚¹å‡»éª°å­å¼€å§‹å­¦ä¹ ä»»åŠ¡</h2>
                        <!-- éª°å­ -->
                        <div id="task-dice" class="w-24 h-24 bg-white rounded-xl mx-auto mb-6 cursor-pointer shadow-lg transition-all hover:scale-110 animate-float flex items-center justify-center">
                            <!-- é™æ€éª°å­ - ä»»åŠ¡tabä½¿ç”¨secondaryé¢œè‰² -->
                            <div class="dice dice-task w-full h-full relative">
                                <div class="dice-dot dice-dot-1"></div>
                                <div class="dice-dot dice-dot-2"></div>
                                <div class="dice-dot dice-dot-3"></div>
                                <div class="dice-dot dice-dot-4"></div>
                                <div class="dice-dot dice-dot-5"></div>
                                <div class="dice-dot dice-dot-6"></div>
                                <div class="dice-dot dice-dot-7"></div>
                            </div>
                        </div>
                        <div class="flex justify-center space-x-4">
                            <button id="regenerate-task" class="bg-white text-secondary px-6 py-3 rounded-full font-bold shadow-md hover:shadow-lg transition-all transform hover:-translate-y-1">
                                é‡æ–°ç”Ÿæˆä»»åŠ¡
                            </button>
                            <button id="complete-task" class="gradient-primary text-white px-6 py-3 rounded-full font-bold shadow-md hover:shadow-lg transition-all transform hover:-translate-y-1">
                                å®Œæˆä»»åŠ¡
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- ä»»åŠ¡åˆ—è¡¨æ ‡é¢˜ -->
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold">ä»»åŠ¡åˆ—è¡¨</h2>
                    <button id="add-task" class="bg-accent hover:bg-opacity-90 text-white px-4 py-2 rounded-full font-medium flex items-center transition-all transform hover:scale-105">
                        <i class="fa fa-plus mr-2"></i> æ·»åŠ ä»»åŠ¡
                    </button>
                </div>
                
                <!-- ä»»åŠ¡åˆ—è¡¨ -->
                <div id="task-list" class="space-y-4 overflow-y-auto flex-1">
                    <!-- ä»»åŠ¡é¡¹ - è¿›è¡Œä¸­ -->
                    <div class="bg-white rounded-xl p-4 shadow-card flex justify-between items-center border-l-4 border-secondary">
                        <div class="flex items-center">
                            <span class="bg-warning/20 text-warning text-xs px-2 py-1 rounded-full mr-3">è¿›è¡Œä¸­</span>
                            <span class="font-medium">æµ‹è¯•2</span>
                        </div>
                        <button class="text-gray-500 hover:text-primary transition-colors">
                            <i class="fa fa-pencil"></i>
                        </button>
                    </div>
                    
                    <!-- ä»»åŠ¡é¡¹ - å·²å®Œæˆ -->
                    <div class="bg-white rounded-xl p-4 shadow-card flex justify-between items-center border-l-4 border-success">
                        <div class="flex items-center">
                            <span class="bg-success/20 text-success text-xs px-2 py-1 rounded-full mr-3">å·²å®Œæˆ</span>
                            <span class="font-medium">å†™å®Œæ–‡çŒ®ç»¼è¿°éƒ¨åˆ†</span>
                        </div>
                        <div class="flex space-x-3">
                            <button class="text-gray-500 hover:text-primary transition-colors">
                                <i class="fa fa-pencil"></i>
                            </button>
                            <button class="text-gray-500 hover:text-danger transition-colors">
                                <i class="fa fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- ä»»åŠ¡é¡¹ - æœªå¼€å§‹ -->
                    <div class="bg-white rounded-xl p-4 shadow-card flex justify-between items-center border-l-4 border-gray-300">
                        <div class="flex items-center">
                            <span class="bg-gray-200 text-gray-600 text-xs px-2 py-1 rounded-full mr-3">æœªå¼€å§‹</span>
                            <span class="font-medium">å¼€å‘å°ç¨‹åº</span>
                        </div>
                        <div class="flex space-x-3">
                            <button class="text-gray-500 hover:text-primary transition-colors">
                                <i class="fa fa-pencil"></i>
                            </button>
                            <button class="text-gray-500 hover:text-danger transition-colors">
                                <i class="fa fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- ä»»åŠ¡é¡¹ - æœªå¼€å§‹ -->
                    <div class="bg-white rounded-xl p-4 shadow-card flex justify-between items-center border-l-4 border-gray-300">
                        <div class="flex items-center">
                            <span class="bg-gray-200 text-gray-600 text-xs px-2 py-1 rounded-full mr-3">æœªå¼€å§‹</span>
                            <span class="font-medium">å¤ä¹ è‹±è¯­å•è¯</span>
                        </div>
                        <div class="flex space-x-3">
                            <button class="text-gray-500 hover:text-primary transition-colors">
                                <i class="fa fa-pencil"></i>
                            </button>
                            <button class="text-gray-500 hover:text-danger transition-colors">
                                <i class="fa fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- ä»»åŠ¡é¡¹ - æœªå¼€å§‹ -->
                    <div class="bg-white rounded-xl p-4 shadow-card flex justify-between items-center border-l-4 border-gray-300">
                        <div class="flex items-center">
                            <span class="bg-gray-200 text-gray-600 text-xs px-2 py-1 rounded-full mr-3">æœªå¼€å§‹</span>
                            <span class="font-medium">å‡†å¤‡æ¼”è®²ææ–™</span>
                        </div>
                        <div class="flex space-x-3">
                            <button class="text-gray-500 hover:text-primary transition-colors">
                                <i class="fa fa-pencil"></i>
                            </button>
                            <button class="text-gray-500 hover:text-danger transition-colors">
                                <i class="fa fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- å¥–åŠ±Tabå†…å®¹ -->
            <div id="rewards-tab" class="hidden h-full flex flex-col">
                <!-- éª°å­å¥–åŠ±åŒºåŸŸ -->
                <div class="bg-gradient-to-r from-pink-400 to-orange-400 rounded-2xl p-6 mb-6 shadow-lg text-center">
                    <h2 class="text-white mb-2">ç‚¹å‡»éª°å­è·å–å¥–åŠ±</h2>
                    <p class="text-white/80 mb-4">å‰©ä½™æŠ•æ·æ¬¡æ•°ï¼š<span id="remaining-rolls">1</span> æ¬¡</p>
                    
                    <!-- éª°å­ -->
                    <div id="reward-dice" class="w-24 h-24 bg-white rounded-xl mx-auto mb-4 cursor-pointer shadow-lg transition-all hover:scale-110 animate-float flex items-center justify-center">
                        <!-- é™æ€éª°å­ - å¥–åŠ±tabä½¿ç”¨primaryé¢œè‰² -->
                        <div class="dice dice-reward w-full h-full relative">
                            <div class="dice-dot dice-dot-1"></div>
                            <div class="dice-dot dice-dot-2"></div>
                            <div class="dice-dot dice-dot-3"></div>
                            <div class="dice-dot dice-dot-4"></div>
                            <div class="dice-dot dice-dot-5"></div>
                            <div class="dice-dot dice-dot-6"></div>
                            <div class="dice-dot dice-dot-7"></div>
                        </div>
                    </div>
                </div>
                
                <!-- ç¢ç‰‡ç»Ÿè®¡ -->
                <div class="bg-white rounded-xl p-5 mb-6 shadow-card">
                    <h3 class="text-lg font-semibold mb-2">å½“å‰ç¢ç‰‡</h3>
                    <div class="flex justify-between items-end">
                        <div>
                            <span id="total-fragments" class="text-3xl font-bold text-primary">25</span>
                            <span class="text-gray-500 ml-1">ä¸ª</span>
                        </div>
                        <span class="text-gray-500 text-sm">å·²ä½¿ç”¨ <span id="used-fragments">5</span> ä¸ª</span>
                    </div>
                </div>
                
                <!-- å¥–åŠ±å…‘æ¢ -->
                <div class="mb-4">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold">å¥–åŠ±å…‘æ¢</h3>
                        <button id="add-reward" class="text-primary hover:text-primary/80 text-sm flex items-center transition-colors">
                            <i class="fa fa-plus mr-1"></i> æ·»åŠ å¥–åŠ±
                        </button>
                    </div>
                    
                    <!-- å¥–åŠ±åˆ—è¡¨ -->
                    <div id="reward-list" class="space-y-3">
                        <!-- å¥–åŠ±é¡¹ -->
                        <div class="bg-white rounded-xl p-4 shadow-card flex justify-between items-center">
                            <div>
                                <p class="font-medium">ä¼‘æ¯30åˆ†é’Ÿ</p>
                                <p class="text-gray-500 text-sm">éœ€è¦ 1 ä¸ªç¢ç‰‡</p>
                            </div>
                            <button class="gradient-primary text-white px-4 py-1.5 rounded-full text-sm font-medium shadow-sm hover:shadow transition-all">
                                å…‘æ¢
                            </button>
                        </div>
                        
                        <!-- å¥–åŠ±é¡¹ -->
                        <div class="bg-white rounded-xl p-4 shadow-card flex justify-between items-center">
                            <div>
                                <p class="font-medium">å¥–åŠ±ä¸€ä¸ªé›ªç³•</p>
                                <p class="text-gray-500 text-sm">éœ€è¦ 3 ä¸ªç¢ç‰‡</p>
                            </div>
                            <button class="gradient-primary text-white px-4 py-1.5 rounded-full text-sm font-medium shadow-sm hover:shadow transition-all">
                                å…‘æ¢
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- å…‘æ¢è®°å½• -->
                <div class="flex-1">
                    <h3 class="text-lg font-semibold mb-4">å…‘æ¢è®°å½•</h3>
                    <div id="exchange-history" class="space-y-3">
                        <!-- å…‘æ¢è®°å½•é¡¹ -->
                        <div class="bg-white rounded-xl p-4 shadow-card flex justify-between items-center">
                            <div>
                                <div class="flex items-center mb-1">
                                    <i class="fa fa-gift text-accent mr-2"></i>
                                    <p class="font-medium">å¥–åŠ±ä¸€ä¸ªé›ªç³•</p>
                                </div>
                                <p class="text-gray-500 text-sm">2025/10/07 ä¸‹åˆ5:36:28</p>
                            </div>
                            <div class="flex items-center text-danger text-sm">
                                <i class="fa fa-diamond mr-1"></i>
                                <span>æ¶ˆè€—3ç¢ç‰‡</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- å­¦ä¹ æˆ˜æŠ¥Tabå†…å®¹ -->
            <div id="stats-tab" class="hidden h-full flex flex-col">
                <!-- ä»Šæ—¥æ¦‚è§ˆ -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="bg-white rounded-xl p-4 shadow-card text-center">
                        <p class="text-gray-500 mb-2">ä»Šæ—¥å®Œæˆä»»åŠ¡</p>
                        <p class="text-2xl font-bold text-green-500">0</p>
                    </div>
                    <div class="bg-white rounded-xl p-4 shadow-card text-center">
                        <p class="text-gray-500 mb-2">ä»Šæ—¥è·å¾—ç¢ç‰‡</p>
                        <p class="text-2xl font-bold text-green-500">2</p>
                    </div>
                    <div class="bg-white rounded-xl p-4 shadow-card text-center">
                        <p class="text-gray-500 mb-2">è¿ç»­å­¦ä¹ </p>
                        <p class="text-2xl font-bold text-green-500">1</p>
                    </div>
                    <div class="bg-white rounded-xl p-4 shadow-card text-center">
                        <p class="text-gray-500 mb-2">æœ¬å‘¨ç¢ç‰‡</p>
                        <p class="text-2xl font-bold text-green-500">14</p>
                    </div>
                </div>
                
                <!-- æœ¬å‘¨ä»»åŠ¡å®Œæˆè¶‹åŠ¿ -->
                <div class="bg-white rounded-xl p-5 mb-6 shadow-card">
                    <h3 class="text-lg font-semibold mb-4">æœ¬å‘¨ä»»åŠ¡å®Œæˆè¶‹åŠ¿</h3>
                    <div class="h-48">
                        <canvas id="weekly-tasks-chart"></canvas>
                    </div>
                </div>
                
                <!-- æœ¬å‘¨ç¢ç‰‡è·å–è¶‹åŠ¿ -->
                <div class="bg-white rounded-xl p-5 mb-6 shadow-card">
                    <h3 class="text-lg font-semibold mb-4">æœ¬å‘¨ç¢ç‰‡è·å–è¶‹åŠ¿</h3>
                    <div class="h-48">
                        <canvas id="weekly-fragments-chart"></canvas>
                    </div>
                </div>
                
                <!-- æœ¬æœˆç»Ÿè®¡ -->
                <div class="bg-white rounded-xl p-5 mb-6 shadow-card">
                    <h3 class="text-lg font-semibold mb-4">æœ¬æœˆç»Ÿè®¡</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="text-center">
                            <p class="text-gray-500 mb-1">æ€»å®Œæˆä»»åŠ¡</p>
                            <div class="flex items-center justify-center h-10">
                                <i class="fa fa-bullseye text-amber-400 mr-1 w-5 text-center"></i>
                                <p class="text-2xl font-bold">11</p>
                            </div>
                        </div>
                        <div class="text-center">
                            <p class="text-gray-500 mb-1">æ€»è·å¾—ç¢ç‰‡</p>
                            <div class="flex items-center justify-center h-10">
                                <i class="fa fa-diamond text-amber-400 mr-1 w-5 text-center"></i>
                                <p class="text-2xl font-bold">30</p>
                            </div>
                        </div>
                        <div class="text-center">
                            <p class="text-gray-500 mb-1">å…‘æ¢æ¬¡æ•°</p>
                            <div class="flex items-center justify-center h-10">
                                <i class="fa fa-gift text-amber-400 mr-1 w-5 text-center"></i>
                                <p class="text-2xl font-bold">0</p>
                            </div>
                        </div>
                        <div class="text-center">
                            <p class="text-gray-500 mb-1">æœ€é«˜å•æ—¥å®Œæˆ</p>
                            <div class="flex items-center justify-center h-10">
                                <i class="fa fa-trophy text-amber-400 mr-1 w-5 text-center"></i>
                                <p class="text-2xl font-bold">10</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- æœ€è¿‘å®Œæˆä»»åŠ¡ -->
                <div class="flex-1">
                    <h3 class="text-lg font-semibold mb-4">æœ€è¿‘å®Œæˆä»»åŠ¡</h3>
                    <div id="recent-tasks" class="space-y-3">
                        <!-- å®Œæˆä»»åŠ¡é¡¹ -->
                        <div class="bg-white rounded-xl p-4 shadow-card flex justify-between items-center">
                            <div class="flex items-center">
                                <i class="fa fa-check-circle text-success mr-3"></i>
                                <p class="font-medium">å†™å®Œæ–‡çŒ®ç»¼è¿°éƒ¨åˆ†</p>
                            </div>
                            <span class="text-gray-500 text-sm">2025-10-07</span>
                        </div>
                        <!-- å®Œæˆä»»åŠ¡é¡¹ -->
                        <div class="bg-white rounded-xl p-4 shadow-card flex justify-between items-center">
                            <div class="flex items-center">
                                <i class="fa fa-check-circle text-success mr-3"></i>
                                <p class="font-medium">å¼€å‘å°ç¨‹åº</p>
                            </div>
                            <span class="text-gray-500 text-sm">2025-10-07</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- åº•éƒ¨Tabæ  -->
        <div class="bg-white border-t border-gray-200 py-2">
            <div class="flex justify-around">
                <button class="tab-button active flex flex-col items-center px-4 py-2" data-tab="tasks">
                    <i class="fa fa-tasks text-xl text-secondary"></i>
                    <span class="text-xs mt-1 text-secondary">ä»»åŠ¡</span>
                </button>
                <button class="tab-button flex flex-col items-center px-4 py-2" data-tab="rewards">
                    <i class="fa fa-gift text-xl text-gray-400"></i>
                    <span class="text-xs mt-1 text-gray-400">å¥–åŠ±</span>
                </button>
                <button class="tab-button flex flex-col items-center px-4 py-2" data-tab="stats">
                    <i class="fa fa-bar-chart text-xl text-gray-400"></i>
                    <span class="text-xs mt-1 text-gray-400">å­¦ä¹ æˆ˜æŠ¥</span>
                </button>
            </div>
        </div>
    </div>
    
    <!-- ä»»åŠ¡ç¼–è¾‘å¼¹çª— -->
    <div id="task-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-2xl p-6 w-10/12 max-w-md mx-auto shadow-2xl transform transition-all animate-float">
            <h3 id="modal-title" class="text-xl font-bold mb-4">æ·»åŠ ä»»åŠ¡</h3>
            <input id="task-name" type="text" placeholder="è¯·è¾“å…¥ä»»åŠ¡åç§°" class="w-full px-4 py-3 border border-gray-300 rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-secondary">
            <div class="flex justify-end space-x-3">
                <button id="cancel-modal" class="px-4 py-2 bg-gray-200 rounded-lg font-medium hover:bg-gray-300 transition-colors">
                    å–æ¶ˆ
                </button>
                <button id="save-task" class="px-4 py-2 gradient-primary text-white rounded-lg font-medium hover:shadow-lg transition-all">
                    ä¿å­˜
                </button>
            </div>
        </div>
    </div>
    
    <!-- éª°å­åŠ¨ç”»å¼¹çª— -->
    <div id="dice-animation-modal" class="fixed inset-0 bg-black/80 flex items-center justify-center hidden z-50">
        <div class="text-center">
            <div id="dice-animation" class="w-32 h-32 bg-white rounded-xl mx-auto mb-6 flex items-center justify-center animate-spin-slow">
                <i class="fa fa-dice text-6xl text-accent"></i>
            </div>
            <p class="text-white text-lg">æ­£åœ¨éšæœºé€‰æ‹©ä»»åŠ¡...</p>
        </div>
    </div>
    
    <!-- æˆåŠŸæç¤ºå¼¹çª— -->
    <div id="success-toast" class="fixed top-10 left-1/2 transform -translate-x-1/2 bg-success text-white px-6 py-3 rounded-full shadow-lg flex items-center z-50 hidden">
        <i class="fa fa-check-circle mr-2"></i>
        <span id="toast-message">ä»»åŠ¡å®Œæˆï¼å¿«å»å¥–åŠ±åŒºé¢†å–å¥–åŠ±å§</span>
    </div>
    
    <!-- ä»»åŠ¡å®Œæˆå¼¹çª— -->
    <div id="task-complete-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-2xl p-6 w-10/12 max-w-md mx-auto shadow-2xl transform transition-all">
            <div class="text-center">
                    <h3 class="text-xl font-bold mb-6 text-success">ä»»åŠ¡å®Œæˆ</h3>
                    <p class="text-gray-600 mb-8 text-lg">ğŸ‰å¿«å»å¥–åŠ±åŒºé¢†å–å¥–åŠ±å§ï¼</p>
                    <button id="confirm-complete" class="px-6 py-2 gradient-primary text-white rounded-lg font-medium hover:shadow-lg transition-all w-full">
                        ç¡®å®š
                    </button>
                </div>
        </div>
    </div>
    
    <!-- åˆ é™¤ç¡®è®¤å¼¹çª— -->
    <div id="delete-confirm-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-2xl p-6 w-10/12 max-w-md mx-auto shadow-2xl transform transition-all">
            <h3 class="text-xl font-bold mb-4 text-center">ç¡®è®¤åˆ é™¤</h3>
            <p class="text-gray-600 text-center mb-6" id="delete-confirm-text">
                ç¡®å®šè¦åˆ é™¤è¯¥ä»»åŠ¡å—ï¼Ÿ
            </p>
            <div class="flex space-x-3">
                <button id="cancel-delete" class="flex-1 px-4 py-2 bg-gray-200 rounded-lg font-medium hover:bg-gray-300 transition-colors">
                    å–æ¶ˆ
                </button>
                <button id="confirm-delete" class="flex-1 px-4 py-2 bg-danger text-white rounded-lg font-medium hover:shadow-lg transition-all">
                    ç¡®å®šåˆ é™¤
                </button>
            </div>
        </div>
    </div>
    
    <!-- æ·»åŠ å¥–åŠ±å¼¹çª— -->
    <div id="reward-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-2xl p-6 w-10/12 max-w-md mx-auto shadow-2xl transform transition-all">
            <h3 id="reward-modal-title" class="text-xl font-bold mb-4">æ·»åŠ å¥–åŠ±</h3>
            <input id="reward-name" type="text" placeholder="è¯·è¾“å…¥å¥–åŠ±åç§°" class="w-full px-4 py-3 border border-gray-300 rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-primary">
            <input id="reward-cost" type="number" placeholder="éœ€è¦çš„ç¢ç‰‡æ•°é‡ (é»˜è®¤30)" min="0" class="w-full px-4 py-3 border border-gray-300 rounded-lg mb-6 focus:outline-none focus:ring-2 focus:ring-primary">
            <div class="flex space-x-3">
                <button id="cancel-reward" class="flex-1 px-4 py-2 bg-gray-200 rounded-lg font-medium hover:bg-gray-300 transition-colors">
                    å–æ¶ˆ
                </button>
                <button id="save-reward" class="flex-1 px-4 py-2 gradient-primary text-white rounded-lg font-medium hover:shadow-lg transition-all">
                    ç¡®å®š
                </button>
            </div>
        </div>
    </div>
    
    <!-- å…‘æ¢ç¡®è®¤å¼¹çª— -->
    <div id="exchange-confirm-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-2xl p-6 w-10/12 max-w-md mx-auto shadow-2xl transform transition-all">
            <h3 class="text-xl font-bold mb-4 text-center">ç¡®è®¤å…‘æ¢</h3>
            <p class="text-gray-600 text-center mb-6" id="exchange-confirm-text">
                ç¡®å®šè¦æ¶ˆè€—1ä¸ªç¢ç‰‡å…‘æ¢ä¼‘æ¯30åˆ†é’Ÿå—ï¼Ÿ
            </p>
            <div class="flex space-x-3">
                <button id="cancel-exchange" class="flex-1 px-4 py-2 bg-gray-200 rounded-lg font-medium hover:bg-gray-300 transition-colors">
                    å–æ¶ˆ
                </button>
                <button id="confirm-exchange" class="flex-1 px-4 py-2 gradient-primary text-white rounded-lg font-medium hover:shadow-lg transition-all">
                    ç¡®å®š
                </button>
            </div>
        </div>
    </div>
    
    <!-- JavaScript -->
    <script>
        // æ•°æ®æ¨¡å‹
        const userData = {
            tasks: [
                { id: 1, name: "æµ‹è¯•2", status: "inProgress", createTime: "2025-10-07", completeTime: null },
                { id: 4, name: "å¤ä¹ è‹±è¯­å•è¯", status: "pending", createTime: "2025-10-07", completeTime: null },
                { id: 5, name: "å‡†å¤‡æ¼”è®²ææ–™", status: "pending", createTime: "2025-10-07", completeTime: null },
                { id: 2, name: "å†™å®Œæ–‡çŒ®ç»¼è¿°éƒ¨åˆ†", status: "completed", createTime: "2025-10-07", completeTime: "2025-10-07" },
                { id: 3, name: "å¼€å‘å°ç¨‹åº", status: "completed", createTime: "2025-10-07", completeTime: "2025-10-07" }
            ],
            rewards: {
                totalFragments: 25,
                usedFragments: 5,
                rewardList: [
                    { id: 1, name: "ä¼‘æ¯30åˆ†é’Ÿ", cost: 1 },
                    { id: 2, name: "å¥–åŠ±ä¸€ä¸ªé›ªç³•", cost: 3 }
                ],
                exchangeHistory: [
                    { id: 1, rewardId: 2, rewardName: "å¥–åŠ±ä¸€ä¸ªé›ªç³•", cost: 3, time: "2025/10/07 ä¸‹åˆ5:36:28" }
                ]
            },
            diceStats: {
                completedTasks: 15,
                usedRolls: 12,
                todayRolls: 1
            }
        };
        
        // DOMå…ƒç´ 
        const app = document.getElementById('app');
        const pageContent = document.getElementById('page-content');
        const tasksTab = document.getElementById('tasks-tab');
        const rewardsTab = document.getElementById('rewards-tab');
        const statsTab = document.getElementById('stats-tab');
        const tabButtons = document.querySelectorAll('.tab-button');
        const taskModal = document.getElementById('task-modal');
        const rewardModal = document.getElementById('reward-modal');
        const diceAnimationModal = document.getElementById('dice-animation-modal');
        const successToast = document.getElementById('success-toast');
        const taskCompleteModal = document.getElementById('task-complete-modal');
        const regenerateTaskBtn = document.getElementById('regenerate-task');
        const completeTaskBtn = document.getElementById('complete-task');
        const currentTaskEl = document.getElementById('current-task');
        const taskDice = document.getElementById('task-dice');
        const rewardDice = document.getElementById('reward-dice');
        const remainingRollsEl = document.getElementById('remaining-rolls');
        
        // Tabåˆ‡æ¢åŠŸèƒ½
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                // ç§»é™¤æ‰€æœ‰activeçŠ¶æ€
                tabButtons.forEach(btn => {
                    btn.classList.remove('active');
                    const icon = btn.querySelector('i');
                    const text = btn.querySelector('span');
                    icon.classList.remove('text-secondary', 'text-primary', 'text-accent', 'text-amber-500');
                    text.classList.remove('text-secondary', 'text-primary', 'text-accent', 'text-amber-500');
                    icon.classList.add('text-gray-400');
                    text.classList.add('text-gray-400');
                });
                
                // æ·»åŠ å½“å‰activeçŠ¶æ€
                button.classList.add('active');
                const icon = button.querySelector('i');
                const text = button.querySelector('span');
                icon.classList.remove('text-gray-400');
                text.classList.remove('text-gray-400');
                
                // æ ¹æ®tabç±»å‹è®¾ç½®ä¸åŒé¢œè‰²
                const tabType = button.getAttribute('data-tab');
                if (tabType === 'tasks') {
                    icon.classList.add('text-secondary');
                    text.classList.add('text-secondary');
                } else if (tabType === 'rewards') {
                    icon.classList.add('text-primary');
                    text.classList.add('text-primary');
                } else if (tabType === 'stats') {
                    icon.classList.add('text-amber-500');
                    text.classList.add('text-amber-500');
                }
                
                // æ˜¾ç¤ºå¯¹åº”å†…å®¹
                tasksTab.classList.add('hidden');
                rewardsTab.classList.add('hidden');
                statsTab.classList.add('hidden');
                
                if (tabType === 'tasks') {
                    tasksTab.classList.remove('hidden');
                } else if (tabType === 'rewards') {
                    rewardsTab.classList.remove('hidden');
                } else if (tabType === 'stats') {
                    statsTab.classList.remove('hidden');
                }
            });
        });
        
        // åˆå§‹åŒ–å›¾è¡¨
        function initCharts() {
            // æœ¬å‘¨ä»»åŠ¡å®Œæˆè¶‹åŠ¿å›¾è¡¨
            const weeklyTasksCtx = document.getElementById('weekly-tasks-chart').getContext('2d');
            new Chart(weeklyTasksCtx, {
                type: 'bar',
                data: {
                    labels: ['å››', 'äº”', 'å…­', 'æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰'],
                    datasets: [{
                        label: 'å®Œæˆä»»åŠ¡æ•°',
                        data: [0, 0, 0, 0, 0, 10, 0],
                        backgroundColor: '#4ECDC4',
                        borderRadius: 8,
                        barThickness: 24
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 5
                            },
                            grid: {
                                display: true,
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
            
            // æœ¬å‘¨ç¢ç‰‡è·å–è¶‹åŠ¿å›¾è¡¨
            const weeklyFragmentsCtx = document.getElementById('weekly-fragments-chart').getContext('2d');
            new Chart(weeklyFragmentsCtx, {
                type: 'line',
                data: {
                    labels: ['å››', 'äº”', 'å…­', 'æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰'],
                    datasets: [{
                        label: 'è·å¾—ç¢ç‰‡æ•°',
                        data: [0, 0, 0, 0, 0, 14, 0],
                        borderColor: '#FF6B6B',
                        backgroundColor: 'rgba(255, 107, 107, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#FF6B6B',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        pointHoverRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 5
                            },
                            grid: {
                                display: true,
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }
        
        // é‡æ–°ç”Ÿæˆä»»åŠ¡
        function regenerateTask() {
            // æ˜¾ç¤ºéª°å­åŠ¨ç”»
            diceAnimationModal.classList.remove('hidden');
            
            // 1ç§’åéšè—åŠ¨ç”»å¹¶ç»§ç»­æ“ä½œ
            setTimeout(() => {
                diceAnimationModal.classList.add('hidden');
                
                // ç­›é€‰æœªå®Œæˆçš„ä»»åŠ¡
                const pendingTasks = userData.tasks.filter(task => task.status === 'pending');
                
                if (pendingTasks.length > 0) {
                    // Fisher-Yatesæ´—ç‰Œç®—æ³•éšæœºé€‰æ‹©
                    const randomIndex = Math.floor(Math.random() * pendingTasks.length);
                    const selectedTask = pendingTasks[randomIndex];
                    
                    // æ›´æ–°å½“å‰ä»»åŠ¡çŠ¶æ€
                    userData.tasks.forEach(task => {
                        if (task.status === 'inProgress') {
                            task.status = 'pending';
                        }
                    });
                    
                    selectedTask.status = 'inProgress';
                    // æ›´æ–°å½“å‰ä»»åŠ¡æ˜¾ç¤º
                    currentTaskEl.textContent = selectedTask.name;
                    
                    // æ›´æ–°ä»»åŠ¡åˆ—è¡¨æ˜¾ç¤º
                    updateTaskList();
                } else {
                    // å¦‚æœæ²¡æœ‰å¾…å¤„ç†ä»»åŠ¡ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„éšæœºä»»åŠ¡
                    const taskNames = ["å­¦ä¹ JavaScriptåŸºç¡€çŸ¥è¯†", "å¤ä¹ è‹±è¯­å•è¯", "åšæ•°å­¦é¢˜", "é˜…è¯»30åˆ†é’Ÿ", "ç»ƒä¹ ç¼–ç¨‹é¢˜ç›®", "å†™ä¸€ç¯‡æ—¥è®°"];
                    const randomTask = taskNames[Math.floor(Math.random() * taskNames.length)];
                    
                    // å…ˆå°†æ‰€æœ‰è¿›è¡Œä¸­ä»»åŠ¡æ”¹ä¸ºå¾…å¤„ç†
                    userData.tasks.forEach(task => {
                        if (task.status === 'inProgress') {
                            task.status = 'pending';
                        }
                    });
                    
                    // åˆ›å»ºæ–°ä»»åŠ¡
                    const newTask = {
                        id: Date.now(),
                        name: randomTask,
                        status: 'inProgress',
                        createTime: new Date().toISOString().split('T')[0],
                        completeTime: null
                    };
                    
                    userData.tasks.unshift(newTask);
                    
                    // æ›´æ–°å½“å‰ä»»åŠ¡æ˜¾ç¤º
                    currentTaskEl.textContent = randomTask;
                    
                    // æ›´æ–°ä»»åŠ¡åˆ—è¡¨
                    updateTaskList();
                }
                
                // æ˜¾ç¤ºæˆåŠŸæç¤º
                showSuccessToast('æ–°ä»»åŠ¡ç”ŸæˆæˆåŠŸï¼');
            }, 1000);
        }
        
        // å®Œæˆä»»åŠ¡
        function completeTask() {
            // æ›´æ–°ä»»åŠ¡çŠ¶æ€
            userData.tasks.forEach(task => {
                if (task.status === 'inProgress') {
                    task.status = 'completed';
                    task.completeTime = new Date().toISOString().split('T')[0];
                    
                    // æ˜¾ç¤ºä»»åŠ¡å®Œæˆå¼¹çª—
                    taskCompleteModal.classList.remove('hidden');
                }
            });
            
            // æ›´æ–°ä»»åŠ¡åˆ—è¡¨
            updateTaskList();
        }
        
        // æ˜¾ç¤ºæˆåŠŸæç¤º
        function showSuccessToast(message) {
            const toastMessage = document.getElementById('toast-message');
            toastMessage.textContent = message;
            successToast.classList.remove('hidden');
            
            // 3ç§’åéšè—
            setTimeout(() => {
                successToast.classList.add('hidden');
            }, 3000);
        }
        
        // æ›´æ–°ä»»åŠ¡åˆ—è¡¨æ˜¾ç¤ºï¼ŒæŒ‰çŠ¶æ€æ’åºï¼šè¿›è¡Œä¸­>æœªå®Œæˆ>å·²å®Œæˆ
        function updateTaskList() {
            const taskList = document.getElementById('task-list');
            
            // æ¸…ç©ºç°æœ‰åˆ—è¡¨
            taskList.innerHTML = '';
            
            // æŒ‰çŠ¶æ€æ’åº
            userData.tasks.sort((a, b) => {
                const statusOrder = { 'inProgress': 0, 'pending': 1, 'completed': 2 };
                return statusOrder[a.status] - statusOrder[b.status];
            });
            
            // é‡æ–°æ¸²æŸ“ä»»åŠ¡åˆ—è¡¨
            userData.tasks.forEach(task => {
                const taskItem = document.createElement('div');
                taskItem.className = 'bg-white rounded-xl p-4 shadow-card flex justify-between items-center';
                taskItem.dataset.taskId = task.id; // æ·»åŠ ä»»åŠ¡IDä½œä¸ºæ•°æ®å±æ€§
                
                // è®¾ç½®å·¦ä¾§è¾¹æ¡†é¢œè‰²
                if (task.status === 'inProgress') {
                    taskItem.classList.add('border-l-4', 'border-warning');
                } else if (task.status === 'completed') {
                    taskItem.classList.add('border-l-4', 'border-success');
                } else {
                    taskItem.classList.add('border-l-4', 'border-gray-300');
                }
                
                // ä»»åŠ¡çŠ¶æ€å’Œåç§°
                const statusClass = task.status === 'inProgress' ? 'bg-warning/20 text-warning' : 
                                    task.status === 'completed' ? 'bg-success/20 text-success' : 
                                    'bg-gray-200 text-gray-600';
                
                const statusText = task.status === 'inProgress' ? 'è¿›è¡Œä¸­' : 
                                  task.status === 'completed' ? 'å·²å®Œæˆ' : 'æœªå¼€å§‹';
                
                taskItem.innerHTML = `
                    <div class="flex items-center">
                        <span class="${statusClass} text-xs px-2 py-1 rounded-full mr-3">${statusText}</span>
                        <span class="font-medium">${task.name}</span>
                    </div>
                    <div class="flex space-x-3">
                        <button class="edit-button text-gray-500 hover:text-primary transition-colors">
                            <i class="fa fa-pencil"></i>
                        </button>
                        ${task.status !== 'inProgress' ? `
                        <button class="delete-button text-gray-500 hover:text-danger transition-colors">
                            <i class="fa fa-trash"></i>
                        </button>
                        ` : ''}
                    </div>
                `;
                
                // æ·»åŠ ç¼–è¾‘æŒ‰é’®äº‹ä»¶ç›‘å¬
                const editButton = taskItem.querySelector('.edit-button');
                if (editButton) {
                    editButton.addEventListener('click', () => {
                        editTask(task.id);
                    });
                }
                
                // æ·»åŠ åˆ é™¤æŒ‰é’®äº‹ä»¶ç›‘å¬
                const deleteButton = taskItem.querySelector('.delete-button');
                if (deleteButton) {
                    deleteButton.addEventListener('click', () => {
                        // ä¿å­˜å½“å‰è¦åˆ é™¤çš„ä»»åŠ¡ID
                        document.getElementById('delete-confirm-modal').dataset.taskId = task.id;
                        document.getElementById('delete-confirm-text').textContent = `ç¡®å®šè¦åˆ é™¤ä»»åŠ¡"${task.name}"å—ï¼Ÿ`;
                        document.getElementById('delete-confirm-modal').classList.remove('hidden');
                    });
                }
                
                taskList.appendChild(taskItem);
            });
        }
        
        // æ·»åŠ ä»»åŠ¡
        function addTask() {
            document.getElementById('modal-title').textContent = 'æ·»åŠ ä»»åŠ¡';
            document.getElementById('task-name').value = '';
            taskModal.classList.remove('hidden');
        }
        
        // å½“å‰æ­£åœ¨ç¼–è¾‘çš„ä»»åŠ¡ID
        let editingTaskId = null;
        
        // ç¼–è¾‘ä»»åŠ¡
        function editTask(taskId) {
            const task = userData.tasks.find(t => t.id === taskId);
            if (task) {
                editingTaskId = taskId;
                document.getElementById('modal-title').textContent = 'ç¼–è¾‘ä»»åŠ¡';
                document.getElementById('task-name').value = task.name;
                taskModal.classList.remove('hidden');
            }
        }
        
        // ä¿å­˜ä»»åŠ¡ï¼ˆæ·»åŠ æˆ–ç¼–è¾‘ï¼‰
        function saveTask() {
            const taskName = document.getElementById('task-name').value.trim();
            if (taskName) {
                if (editingTaskId) {
                    // ç¼–è¾‘ç°æœ‰ä»»åŠ¡
                    const taskIndex = userData.tasks.findIndex(t => t.id === editingTaskId);
                    if (taskIndex !== -1) {
                        userData.tasks[taskIndex].name = taskName;
                        showSuccessToast('ä»»åŠ¡æ›´æ–°æˆåŠŸï¼');
                    }
                    editingTaskId = null;
                } else {
                    // åˆ›å»ºæ–°ä»»åŠ¡
                    const newTask = {
                        id: Date.now(),
                        name: taskName,
                        status: 'pending',
                        createTime: new Date().toISOString().split('T')[0],
                        completeTime: null
                    };
                    
                    userData.tasks.push(newTask);
                    showSuccessToast('ä»»åŠ¡æ·»åŠ æˆåŠŸï¼');
                }
                
                taskModal.classList.add('hidden');
                
                // æ›´æ–°ä»»åŠ¡åˆ—è¡¨
                updateTaskList();
            }
        }
        
        // ç¡®è®¤åˆ é™¤ä»»åŠ¡
        function confirmDeleteTask() {
            const taskId = parseInt(document.getElementById('delete-confirm-modal').dataset.taskId);
            const taskIndex = userData.tasks.findIndex(t => t.id === taskId);
            
            if (taskIndex !== -1) {
                userData.tasks.splice(taskIndex, 1);
                document.getElementById('delete-confirm-modal').classList.add('hidden');
                
                // æ›´æ–°ä»»åŠ¡åˆ—è¡¨
                updateTaskList();
                
                // æ˜¾ç¤ºæˆåŠŸæç¤º
                showSuccessToast('ä»»åŠ¡å·²åˆ é™¤ï¼');
            }
        }
        
        // å–æ¶ˆåˆ é™¤ä»»åŠ¡
        function cancelDeleteTask() {
            document.getElementById('delete-confirm-modal').classList.add('hidden');
        }
        
        // æŠ•æ·å¥–åŠ±éª°å­
        function rollRewardDice() {
            const remainingRolls = parseInt(remainingRollsEl.textContent);
            if (remainingRolls <= 0) {
                showSuccessToast('æ²¡æœ‰å‰©ä½™æŠ•æ·æ¬¡æ•°äº†ï¼Œå®Œæˆæ›´å¤šä»»åŠ¡è·å–æ¬¡æ•°ï¼');
                return;
            }
            
            // æ˜¾ç¤ºéª°å­åŠ¨ç”»
            diceAnimationModal.classList.remove('hidden');
            
            // 1ç§’åéšè—åŠ¨ç”»å¹¶ç»§ç»­æ“ä½œ
            setTimeout(() => {
                diceAnimationModal.classList.add('hidden');
                
                // éšæœºç”Ÿæˆå¥–åŠ±ï¼ˆæ¦‚ç‡åˆ†å¸ƒï¼‰
                const rewards = [1, 1, 1, 2, 2, 3]; // æ›´åå‘äºå°å¥–åŠ±
                const randomReward = rewards[Math.floor(Math.random() * rewards.length)];
                
                // æ›´æ–°ç¢ç‰‡æ•°é‡
                userData.rewards.totalFragments += randomReward;
                document.getElementById('total-fragments').textContent = userData.rewards.totalFragments;
                
                // å‡å°‘æŠ•æ·æ¬¡æ•°
                const newRemainingRolls = remainingRolls - 1;
                remainingRollsEl.textContent = newRemainingRolls;
                
                // æ›´æ–°ä½¿ç”¨æ¬¡æ•°ç»Ÿè®¡
                userData.diceStats.usedRolls++;
                
                // æ˜¾ç¤ºå¥–åŠ±æç¤º
                showSuccessToast(`æ­å–œè·å¾— ${randomReward} ä¸ªç¢ç‰‡ï¼`);
            }, 1000);
        }
        
        // æ·»åŠ å¥–åŠ±
        function addReward() {
            document.getElementById('reward-modal-title').textContent = 'æ·»åŠ å¥–åŠ±';
            document.getElementById('reward-name').value = '';
            document.getElementById('reward-cost').value = '';
            rewardModal.classList.remove('hidden');
        }
        
        // ä¿å­˜å¥–åŠ±
        function saveReward() {
            const rewardName = document.getElementById('reward-name').value.trim();
            const rewardCost = parseInt(document.getElementById('reward-cost').value) || 30;
            
            if (rewardName) {
                // åˆ›å»ºæ–°å¥–åŠ±
                const newReward = {
                    id: Date.now(),
                    name: rewardName,
                    cost: rewardCost
                };
                
                userData.rewards.rewardList.push(newReward);
                rewardModal.classList.add('hidden');
                
                // æ›´æ–°å¥–åŠ±åˆ—è¡¨UI
                updateRewardList();
                
                // æ˜¾ç¤ºæˆåŠŸæç¤º
                showSuccessToast('å¥–åŠ±æ·»åŠ æˆåŠŸï¼');
            }
        }
        
        // æ›´æ–°å¥–åŠ±åˆ—è¡¨
        function updateRewardList() {
            const rewardListEl = document.getElementById('reward-list');
            rewardListEl.innerHTML = '';
            
            userData.rewards.rewardList.forEach(reward => {
                const rewardItem = document.createElement('div');
                rewardItem.className = 'bg-white rounded-xl p-4 shadow-card flex justify-between items-center';
                
                // åˆ¤æ–­ç¢ç‰‡æ˜¯å¦è¶³å¤Ÿ
                const isFragmentEnough = userData.rewards.totalFragments >= reward.cost;
                
                // æ„å»ºå¥–åŠ±é¡¹å†…å®¹
                let rewardContent = `
                    <div>
                        <p class="font-medium">${reward.name}</p>
                        <p class="text-gray-500 text-sm">éœ€è¦ ${reward.cost} ä¸ªç¢ç‰‡</p>
                    </div>`;
                
                // æ·»åŠ å…‘æ¢æŒ‰é’®æˆ–ç¢ç‰‡ä¸è¶³æç¤º
                if (!isFragmentEnough) {
                    rewardContent += `
                        <div class="bg-warning/20 text-warning px-4 py-1.5 rounded-full text-sm font-medium flex items-center">
                            <i class="fa fa-times-circle mr-1"></i> ç¢ç‰‡æ•°é‡ä¸è¶³
                        </div>`;
                } else {
                    rewardContent += `
                        <button class="gradient-primary text-white px-4 py-1.5 rounded-full text-sm font-medium shadow-sm hover:shadow transition-all">
                            å…‘æ¢
                        </button>`;
                }
                
                rewardItem.innerHTML = rewardContent;
                rewardListEl.appendChild(rewardItem);
            });
            
            // é‡æ–°è®¾ç½®å…‘æ¢æŒ‰é’®äº‹ä»¶ç›‘å¬
            setupExchangeButtons();
        }
        
        // æ‰“å¼€å…‘æ¢ç¡®è®¤å¼¹çª—
        function openExchangeConfirm(reward) {
            selectedReward = reward;
            const confirmText = `ç¡®å®šè¦æ¶ˆè€— ${reward.cost} ä¸ªç¢ç‰‡å…‘æ¢${reward.name}å—ï¼Ÿ`;
            document.getElementById('exchange-confirm-text').textContent = confirmText;
            document.getElementById('exchange-confirm-modal').classList.remove('hidden');
        }
        
        // ç¡®è®¤å…‘æ¢
        function confirmExchange() {
            if (selectedReward && userData.rewards.totalFragments >= selectedReward.cost) {
                // æ‰£é™¤ç¢ç‰‡
                userData.rewards.totalFragments -= selectedReward.cost;
                userData.rewards.usedFragments += selectedReward.cost;
                
                // æ›´æ–°æ˜¾ç¤º
                document.getElementById('total-fragments').textContent = userData.rewards.totalFragments;
                document.getElementById('used-fragments').textContent = userData.rewards.usedFragments;
                
                // æ·»åŠ å…‘æ¢è®°å½•
                const now = new Date();
                const formattedTime = `${now.getFullYear()}/${String(now.getMonth() + 1).padStart(2, '0')}/${String(now.getDate()).padStart(2, '0')} ${now.getHours() > 12 ? 'ä¸‹åˆ' : 'ä¸Šåˆ'}${String(now.getHours() % 12 || 12).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}:${String(now.getSeconds()).padStart(2, '0')}`;
                
                const newHistoryItem = {
                    id: Date.now(),
                    rewardId: selectedReward.id,
                    rewardName: selectedReward.name,
                    cost: selectedReward.cost,
                    time: formattedTime
                };
                
                userData.rewards.exchangeHistory.unshift(newHistoryItem);
                
                // å…³é—­å¼¹çª—
                document.getElementById('exchange-confirm-modal').classList.add('hidden');
                
                // æ˜¾ç¤ºæˆåŠŸæç¤º
                showSuccessToast(`æˆåŠŸå…‘æ¢ ${selectedReward.name}ï¼`);
            } else {
                showSuccessToast('ç¢ç‰‡æ•°é‡ä¸è¶³ï¼', 'error');
                document.getElementById('exchange-confirm-modal').classList.add('hidden');
            }
        }
        
        // å–æ¶ˆå…‘æ¢
        function cancelExchange() {
            document.getElementById('exchange-confirm-modal').classList.add('hidden');
            selectedReward = null;
        }
        
        // å½“å‰é€‰ä¸­çš„å¥–åŠ±
        let selectedReward = null;
        
        // äº‹ä»¶ç›‘å¬
        regenerateTaskBtn.addEventListener('click', regenerateTask);
        completeTaskBtn.addEventListener('click', completeTask);
        taskDice.addEventListener('click', regenerateTask);
        document.getElementById('add-task').addEventListener('click', addTask);
        document.getElementById('save-task').addEventListener('click', saveTask);
        document.getElementById('cancel-modal').addEventListener('click', () => {
            taskModal.classList.add('hidden');
            // é‡ç½®ç¼–è¾‘çŠ¶æ€
            editingTaskId = null;
        });
        document.getElementById('confirm-complete').addEventListener('click', () => {
            taskCompleteModal.classList.add('hidden');
        });
        
        // åˆ é™¤ç¡®è®¤å¼¹çª—æŒ‰é’®äº‹ä»¶ç›‘å¬
        document.getElementById('confirm-delete').addEventListener('click', confirmDeleteTask);
        document.getElementById('cancel-delete').addEventListener('click', cancelDeleteTask);
        document.getElementById('add-reward').addEventListener('click', addReward);
        document.getElementById('save-reward').addEventListener('click', saveReward);
        document.getElementById('cancel-reward').addEventListener('click', () => {
            rewardModal.classList.add('hidden');
        });
        document.getElementById('confirm-exchange').addEventListener('click', confirmExchange);
        document.getElementById('cancel-exchange').addEventListener('click', cancelExchange);
        rewardDice.addEventListener('click', rollRewardDice);
        
        // ä¸ºå…‘æ¢æŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬
        function setupExchangeButtons() {
            const exchangeButtons = document.querySelectorAll('#reward-list .gradient-primary');
            exchangeButtons.forEach((button, index) => {
                button.addEventListener('click', () => {
                    openExchangeConfirm(userData.rewards.rewardList[index]);
                });
            });
        }
        
        // åˆå§‹åŒ–
        function init() {
            // åˆå§‹åŒ–å›¾è¡¨
            initCharts();
            
            // è®¡ç®—å‰©ä½™æŠ•æ·æ¬¡æ•°
            const remainingRolls = userData.diceStats.completedTasks - userData.diceStats.usedRolls;
            remainingRollsEl.textContent = Math.max(0, remainingRolls);
            
            // æ›´æ–°å½“å‰ä»»åŠ¡æ˜¾ç¤º
            const inProgressTask = userData.tasks.find(task => task.status === 'inProgress');
            if (inProgressTask) {
                currentTaskEl.textContent = inProgressTask.name;
            }
            
            // æ›´æ–°ä»»åŠ¡åˆ—è¡¨
            updateTaskList();
            
            // æ›´æ–°å¥–åŠ±åˆ—è¡¨å¹¶è®¾ç½®å…‘æ¢æŒ‰é’®äº‹ä»¶ç›‘å¬
            updateRewardList();
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>